<!DOCTYPE html><html lang="en-US" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions | Yuchen You</title><meta name="author" content="Yuchen You (Wesley)"><meta name="copyright" content="Yuchen You (Wesley)"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="When a failure occurs in production systems, the highest priority is to quickly mitigate(缓解) it. Failure Mitigation (FM) is done in a reactive and ad-hoc way, namely taking some fixed actions only aft">
<meta property="og:type" content="article">
<meta property="og:title" content="2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions">
<meta property="og:url" content="http://example.com/2025/05/13/wesley_knowledge_repo/os/OrderLab/2.%20Predictive%20and%20Adaptive%20Failure%20Mitigation%20to%20Avert%20Production%20Cloud%20VM%20Interruptions/index.html">
<meta property="og:site_name" content="Yuchen You">
<meta property="og:description" content="When a failure occurs in production systems, the highest priority is to quickly mitigate(缓解) it. Failure Mitigation (FM) is done in a reactive and ad-hoc way, namely taking some fixed actions only aft">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/me_new.jpeg">
<meta property="article:published_time" content="2025-05-13T08:01:27.000Z">
<meta property="article:modified_time" content="2025-05-15T17:00:07.653Z">
<meta property="article:author" content="Yuchen You (Wesley)">
<meta property="article:tag" content="distributed_sys">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/me_new.jpeg"><link rel="shortcut icon" href="/img/hackerrank.svg"><link rel="canonical" href="http://example.com/2025/05/13/wesley_knowledge_repo/os/OrderLab/2.%20Predictive%20and%20Adaptive%20Failure%20Mitigation%20to%20Avert%20Production%20Cloud%20VM%20Interruptions/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-16 01:00:07'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/me_new.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">253</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/math_master.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="Yuchen You"><img class="site-icon" src="/img/avatar.png"/><span class="site-name">Yuchen You</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-05-13T08:01:27.000Z" title="Created 2025-05-13 16:01:27">2025-05-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-15T17:00:07.653Z" title="Updated 2025-05-16 01:00:07">2025-05-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>When a failure occurs in production systems, the highest priority is to quickly mitigate(缓解) it.</p>
<p>Failure Mitigation (FM) is done in a reactive and <strong>ad-hoc way</strong>, namely taking some <strong>fixed actions</strong> only after a severe symptom is observed.</p>
<p>Propose a <strong>preventive</strong> and <strong>adaptive</strong> failure mitigation service, <em><strong>NARYA</strong></em>, that is integraed in a production cloud, Microsoft Azure’s compute platform</p>
<ul>
<li>Narya predicts imminent(迫在眉睫的) host failures based on multi-layer system signals</li>
<li>then decides smart mitigation actions</li>
<li><em>goal</em>: avert(避免) VM failures</li>
<li>Narya’s decision engine takes a novel online experimentation approach to continually explore the best mitigation action.
<ul>
<li>enhances the adaptive decision capability through reinforcement learning.</li>
</ul>
</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p><em><strong>key question</strong></em></p>
<p>once a failure occurs, how to quickly detect and mitigate it so the system can continue running?</p>
<p>Mitigating a failure here means <strong>attempting to make the failure symptom disappear <em>without necessarily diagnosing and fixing</em> the underlying bugs first.</strong></p>
<p><strong>Problem</strong>: for large cloud infrastructure (like Ali-Cloud), only employing <strong>post-failure</strong>(失败后的) detection and mitigation techniques is insufficient.</p>
<p>Cloud systems should also design techniques to address the question of, whether a failure may be imminent, and if so, what preventive actions should be taken to avert this failure?</p>
<p><em><strong>Current Work and Limits</strong></em></p>
<p>Several recent works tackle the failure prediction problem in the context of <strong>disk failures</strong>. But they <strong>focus on prediction alone</strong>, with the goal of alerting operators or providing allocation hints</p>
<p><em><strong>Narya</strong></em></p>
<p>An end-to-end service with predictive and smart failure mitigation fully integrated in the Azure compute platform for its Virtual Machine (VM) host environment.</p>
<p><strong>Goal of Narya</strong>: prevent VM failures ahead of time and enhance the self-managing capability of the Azure compute platform for providing smooth VM experience to customers</p>
<p><strong>Challenge</strong>:</p>
<ol>
<li>(背景原因:)With multi-tenancy, heterogeneous infrastructure components, and diverse customer workloads, it is difficult to(操作难度) <strong>comprehensively categorize different failure scenarios</strong> in a large cloud system beforehand and <strong>determine good mitigation actions</strong> (or their parameters), especially <strong>without trying it</strong></li>
<li>the cloud system is constantly changing (software/hardware updates, customer workload changes), some mitigation action that <strong>worked well in the past may no longer be optimal.</strong></li>
</ol>
<p>Nothing is accessable or assessable before we try it: explorations with <em>production workload</em> is indispensable(必不可少的) to determine the (near-)optimal failure mitigation action.</p>
<p>should ensure that the <strong>actions</strong> taken <strong>maximize the expected effectiveness</strong> (minimize the potential customer impact) over time</p>
<p><em><strong>A/B Testing</strong></em></p>
<p>Narya predicts whether host nodes in the production fleet will likely fail and then <strong>leverages A/B testing</strong> to continually experiment with different mitigation actions, measure the benefits, and discover optimal actions.</p>
<h2 id="background-and-motivation">Background and Motivation</h2>
<p><em><strong>Traditional System</strong></em></p>
<p>A traditional system’s operation cycle is as follows: a failure is detected; developers diagnose the failure and find out the root cause; a patch is written; the system is re-deployed.</p>
<p><em><strong>Cloud System</strong></em></p>
<p>operating in this exact sequence is problematic</p>
<p>because the time it takes to identify the root cause and develop a fix is usually long and exceeds the downtime budget.</p>
<p>Instead, once a failure is detected, some mitigation action like <strong>restart</strong> (<em>重启解决 90% 的问题, 重启两次解决 99% 的问题</em>) will be applied first without necessarily knowing the bug.</p>
<h3 id="target-system-and-goal">Target System and Goal</h3>
<p>Our specific target system is the VM host environment, a <em><strong>node</strong></em></p>
<p>The node is backed by <strong>locally attached disks</strong> and <strong>remote virtual disks</strong>. Each node is connected to various <strong>compute services</strong>, together referred to as <strong>controller</strong>, that is responsible for <strong>provisioning resources</strong> and <strong>performing management actions</strong> such as creating and destroying VMs.</p>
<p>Currently Azure already has monitor (real-time detect the failure), but we want to <em><strong>predict</strong></em></p>
<p>The end goal is to <strong>avoid</strong> future VM failure events.</p>
<h3 id="are-failures-predictable">Are Failures Predictable</h3>
<p>2 Basic Requirements:</p>
<ol>
<li>the imminent failure is <strong>not abrupt</strong></li>
<li>there is <strong>telemetry recorded</strong> to indicate the degradation</li>
</ol>
<p>Hardware Wear Out: predict the failure by the age of the hardware, combined with other system signals such as workload patterns</p>
<p>Software Resource Leak: including memory/file handle/network ports leak, is a common type of predictable software failure. Predict them using the resource usage trend. If failures are correlated with certain hidden factors such as timeout settings, bugs related to timers, and release schedule, they may also occur on a predictable basis.</p>
<h3 id="why-static-mitigation-is-insufficient">Why Static Mitigation is Insufficient</h3>
<p>If we use fixed plan for VM failures, then we follow these steps</p>
<ol>
<li>block allocation on the node;
<ol>
<li>problem here: Blocking allocation results in capacity pressure while for some predicted failures, avoiding allocation may be better.</li>
</ol>
</li>
<li>try to live migrate VMs;
<ol>
<li>Some failures may be too severe to do live migration (e.g., broken disks). Forced migration causes unnecessary customer impact if nodes are still healthy after 7 days.</li>
</ol>
</li>
<li>wait for 7 days for short-lived VMs to be destroyed by customers;</li>
<li>force migration of remaining VMs;</li>
<li>mark the node offline and send it for repair;
<ol>
<li>Marking nodes offline is also suboptimal when capacity is low</li>
</ol>
</li>
</ol>
<h2 id="overview">Overview</h2>
<p>Narya advances the current practice of failure mitigation in two ways:</p>
<ol>
<li>replacing existing static and ad-hoc mitigation assignment to adaptive and systematic decision algorithms;</li>
<li>transforming the traditionally reactive, post-failure mitigation activity to proactive failure avoidance mechanisms.</li>
</ol>
<h3 id="workflow">Workflow</h3>
<p><img src="/images/narya_highlevel_workflow.png" alt="narya_highlevel_workflow.png"></p>
<h3 id="optimization-metric">Optimization Metric</h3>
<p>objective is to reduce and minimize the overall customer impact caused by node failures on the fleet</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>AIR (Annual Interrupt Rate)</mtext><mo>=</mo><mfrac><mrow><mtext>VM interruption count in </mtext><mi>T</mi></mrow><mrow><mtext>Total VM lifetime in </mtext><mi>T</mi></mrow></mfrac><mo>×</mo><mn>365</mn><mtext> </mtext><mtext>days</mtext><mo>×</mo><mn>100</mn><mtext> </mtext><mtext>VMs</mtext></mrow><annotation encoding="application/x-tex">\text{AIR (Annual Interrupt Rate)} = \frac{\text{VM interruption count in } T}{\text{Total VM lifetime in } T} \times 365 \, \text{days} \times 100 \, \text{VMs}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">AIR (Annual Interrupt Rate)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Total VM lifetime in </span></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">VM interruption count in </span></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord">6</span><span class="mord">5</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">days</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">VMs</span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> is any given measured interval duration in days</li>
<li>VM interruption in this paper mainly refers to reboots or loss of heartbeats</li>
</ul>
<p><em><strong>Optimization Background in Azure</strong></em></p>
<p>First, long-duration incidents are now rare in Azure. VM interruptions become more common that require addressing</p>
<p>Second, short VM interruptions can significantly disrupt user experiences, e.g., for gaming type applications.</p>
<p>Third, for VMs that run applications like databases, even if the VM only experiences a short interruption, the applications take time to recover, which translates into a longer user-perceived interruption.</p>
<p>Fourth, based on communications with customers, customers can be more annoyed if their VMs get frequently interrupted when compared to a single longer-time interruption.</p>
<h3 id="challenges">Challenges</h3>
<p>First, failure mitigation has to <strong>act with incomplete information</strong> since the underlying root cause is not known.</p>
<p>Second, due to the massive scale of a cloud system, there are many factors to consider in the decision logic.</p>
<p>Third, our experience suggests that when incorporating failure prediction into a production cloud system, <strong>false positives are unavoidable</strong> due to the complex system environment, large number of noisy signals, unexpected customer workloads, etco</p>
<p>Lastly, failure mitigation is a mission critical procedure. If not designed well, a decision engine <strong>may do more harm than good</strong>. <strong>Ensuring safety</strong> should be a top priority for Narya.</p>
<h2 id="predicting-node-failures">Predicting Node Failures</h2>
<p>describe two prediction methods Narya uses:<br>
(1) <strong>static threshold</strong> rules written by domain experts;<br>
(2) machine learning model-based prediction</p>
<h3 id="input-signals">Input Signals</h3>
<p>Narya consumes telemetry signals from the entire stack of the host environment to make informed prediction.</p>
<p><strong>Hardware/Firmware</strong>: the monitoring agents collect low-level logs from disk SMART attributes, memory (e.g., uncorrectable errors), CPU (e.g., machine check error), motherboard (e.g., bus error), etc.</p>
<p>A <strong>higher-level source of signals</strong> comes from device drivers, e.g., timeout events</p>
<p><strong>Repetition</strong> of such events is often an indicator of an imminent failure</p>
<p><strong>Control-Plane Operations</strong>: For example, repetitive VM creation operation errors could indicate serious host issues even if the host still appears to be running. Such signals help reduce the observability gap</p>
<h3 id="rule-based-prediction">Rule-based Prediction</h3>
<p>Analyze the common failure patterns and the available telemetry signals to predict failures that have significant customer impact.</p>
<p>rules are manually written in json/py/cpp, they are simple and easy to understand</p>
<p>works <strong>best</strong> for <strong>definitive</strong> <strong>signals</strong> that indicate some severe issue with high confidence</p>
<p><em><strong>Drawbacks/Limitations</strong></em></p>
<p>Since many failure signals are not definitive, rule-based prediction cannot cover a wide range of imminent failures. In addition, the prediction may come late and do not provide enough lead time for the mitigation engine.</p>
<h3 id="learning-based-prediction">Learning-based Prediction</h3>
<p>It can predict many complex host failures. It also can predict earlier, thus leaving longer time for the mitigation engine to react.</p>
<p>Use <strong>supervised</strong> learning, which is similar to the previous works, but a <strong>main difference</strong> is that we focus on <strong>overall</strong> host health and failures that <strong>result in customer impact</strong>, instead of failures of individual components.</p>
<p><em><strong>Learning Labels</strong></em></p>
<ul>
<li><strong>Negative Label</strong>: normal state</li>
<li><strong>Positive Label</strong>: dangerous to failure state</li>
</ul>
<p><strong>Short Time</strong>: For Narya, the host view of a failure is different from individual components’ view. The host failures could be unresponsive host, VM creation failure, host OS crash, etc. These temporary failure could happen much earlier than the permanent failure of a component.</p>
<p><strong>System-View</strong>: certain faults might not be a problem to the source component but could be problematic from host’s view.</p>
<p>To get accurate and useful prediction result, we <strong>only</strong> use <strong>host failures</strong> that <strong>result in customer impact</strong> and are <strong>later con- firmed to be caused by some hardware component faults</strong> during diagnosis.</p>
<p><img src="/images/narya_horizon.png" alt="narya_horizon.png"></p>
<p>For training, it use the time unit <strong>hour</strong>, which means that it attach positive label for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> back to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">t - n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>, and that before <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t-(n+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> it is labeled as negative. The variable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> is called the <em><strong>horizon</strong></em> (usurally production horizon is set ot 7 days)</p>
<p>we looked at the feature distribution of failed nodes and measured the same distribution of healthy nodes.</p>
<p><em><strong>Machine Learning Model</strong></em></p>
<p><strong>Binary Classifier</strong>: given signals, labels, host metadata, Narya’s predictor output hte failure probability of a host (we use 0.5 as the cutoff).</p>
<ul>
<li>Gradient boosted tree model (commonly used supervised learning method)
<ul>
<li>combines decisions from a sequence of simple decision trees with a model ensembling(集成的) technique called gradient boosting</li>
</ul>
</li>
<li>Attention-based deep learning model
<ul>
<li>reducing the feature engineering efforts by directly learning the features</li>
<li>aim to learn both spatial features and temporal features
<ul>
<li>Spatial: compare one component to its neighbors, e.g., one host often has multiple disks configured under <strong>RAID 0</strong> (一排硬盘同时写入无 replica), thus they are expected to perform similarly -&gt; if one disk is slower, then considered as imminent host failure</li>
</ul>
</li>
<li>The temporal features characterize changes in components over time</li>
</ul>
</li>
</ul>
<p><img src="/images/narya_ml_model.png" alt="narya_ml_model.png"></p>
<ol>
<li><strong>dimension adapter layer</strong> to unify the dimension of signals from different sources</li>
<li>employ a <strong>spatial information encoder</strong> based on self-attention
<ol>
<li>calculates weights of a component’s neighbors</li>
<li>the weighted sum of the neighbors’ feature vector represent its spatial information</li>
</ol>
</li>
<li>the <strong>temporal information encoder</strong>
<ol>
<li>consists of positional encoding, self-attention, and location-based attention layers.</li>
</ol>
</li>
<li>employ a fusion layer to do binary classification.</li>
</ol>
<h2 id="mitigation-actions">Mitigation Actions</h2>
<p><img src="/images/narya_action_table.png" alt="narya_action_table.png"></p>
<p>Table 2 lists the main <strong>primitive</strong> actions in Azure. Mitigating a failure often requires <strong>multiple primitive actions</strong></p>
<p>An <strong>aggressive goal</strong> for Narya is to explore the actions <strong>arbitrarily</strong> and figure out the <strong>optimal combination</strong>. But this could potentially bring significant customer impact. Instead, Narya mitigation engine focuses on exploring <strong>pre-defined composite actions</strong></p>
<p>Followings are implementations of the primitive actions</p>
<p><em><strong>Live Migration</strong></em></p>
<p><strong>Goal</strong>: moves a <strong>running</strong> VM from one host to another with minimum disruptions.</p>
<p>Migration process involves transfer of the VM’s memory, processor and virtual device state</p>
<ol>
<li>The LM engine iteratively copies the VM’s memory pages while maintaining a dirty page set for the VM on the source host.</li>
<li>Based on the dirty page rate, network bandwidth, the engine determines the maximum iterations to <strong>stop</strong> the VM</li>
<li>After the VM is stopped, the LM engine <strong>synchronizes</strong> the <strong>dirty</strong> <strong>state</strong> with the <strong>target</strong> and <strong>resumes</strong> the VM on the target host</li>
</ol>
<p><em><strong>VM Preserving Soft Reboot</strong></em></p>
<p>Used to preserve the VM state across a reboot of the host OS</p>
<p>The host OS kernel is reloaded into memory, the VM memory and device state are persisted to the newly loaded kernel.</p>
<p>The persisted state is restored and the rest of the state in the prior kernel are discarded</p>
<p>The restored VM experiences a <strong>brief pause</strong> similar to the live migration</p>
<p><em><strong>Service Healing</strong></em></p>
<p>used to restore the service availability of unhealthy or faulty VMs</p>
<p>Live Migration can fail or cannot be applied due to certain constraints such as network boundary</p>
<p>Service healing works for more general scenarios:  The faulted VMs will be isolated by powering down or disconnecting from network. The controller generates a new assignment of the VM to healthy nodes</p>
<p><em><strong>Mark Unallocatable</strong></em></p>
<p>blocks allocation of new VMs to a host for some time T</p>
<p>often used before other primitive actions(like LM) are taken (recall eecs482 final’s last problem use the pin and unpin to protect the disk io lock).</p>
<p><em><strong>Avoid</strong></em></p>
<p>informs the allocator to try to avoid adding new VMs <strong>on this host</strong> (weaker constraint)</p>
<p>Blocking allocation has a strong impact on capacity since the host is not eligible for getting new VMs.</p>
<p>Thus, the number of hosts that can be marked unallocatable at the same time is limited (also recall the eecs482 final, pin has a upper bound, but not the exact same reason here).</p>
<p><em><strong>NoOp</strong></em></p>
<p>he controller does not take any action. This is the <strong>baseline</strong> to measure the benefits of prediction and taking actions.</p>
<h2 id="decision-logic-for-adaptive-mitigation">Decision Logic for Adaptive Mitigation</h2>
<h3 id="online-experimentation-with-a-b-testing">Online Experimentation with A/B Testing</h3>
<h2 id="narya-system-design-and-implementation">Narya System Design and Implementation</h2>
<p>describe the system support for Narya</p>
<p><img src="/images/narya_sys_support.png" alt="narya_sys_support.png"></p>
<p>The Narya system must be able to <strong>process the massive signals and requests</strong> from the <strong>entire fleet</strong> with <strong>low latency</strong> and <strong>reliability</strong>.</p>
<h3 id="failure-predictor">Failure Predictor</h3>
<p>deploys various agents in each node to monitor the health of the host environment. The Narya predictor ingests(摄取) <strong>health signals</strong> from these monitoring agents and runs rule based prediction and ML-based prediction</p>
<p><strong>Rule-based</strong> prediction has low cost and high priority. Thus its prediction logic is executed directly in the host</p>
<p><strong>ML-based</strong> prediction inspects much more signals such as performance counters and runs more complex prediction logic. Thus, the ML predictor is implemented as a centralized service.</p>
<p>It(ML-based) collects raw signals from monitoring agents using micro-batches (small groups) and incrementally processes them. Open source technologies are used for ML modeling (LightGBM + PyTorch).</p>
<p><em><strong>Pub/Sub Service 发布订阅模式服务 (Publish+Subscribe)</strong></em></p>
<p>A mitigation request is created if a node is predicted to fail with high probability.</p>
<p>The predictor <strong>publishes</strong> the request along with metadata information about the host (e.g., hardware generations, OS version) to a <strong>central pub/sub service</strong>, which we implement on top of <strong>Kafka</strong>.</p>
<h3 id="mitigation-engine">Mitigation Engine</h3>
<p>Internally, it is composed of four major microservices. These microservices communicate with each other and other services in Azure using REST APIs.</p>
<p><em><strong>Create Mitigation Job</strong></em></p>
<p>The Request Handler microservice consumes(Kafka Consumer) mitigation requests from the Pub/Sub service.</p>
<p>Upon receiving a mitigation request, it creates a mitigation job with a job Id. This job Id is used by other micro-services to track the mitigation and query its progress.</p>
<p><em><strong>Instantiate Mitigation Policy</strong></em></p>
<p>For a new mitigation job, the Policy Generator creates a mitigation policy, which <em>maps the information from the request to the action to take</em>. (represented as a decision tree)</p>
<p>2 types of nodes:</p>
<ul>
<li><code>Selection</code> node, which chooses the tree node to visit next based on some <code>C#</code> predicate;</li>
<li><code>Action</code> node, which executes a user-defined <code>C#</code> function.</li>
</ul>
<p>The decision tree structure allows us to easily specify the decision logic.</p>
<p>The policy generator then applies <strong>safety constraints</strong> on the retrieved exploration setting to obtain an adjusted action probability distribution.</p>
<p>Additionally, the mitigation policy allows imposing rate limit for a tree node to avoid excessive mitigation that could cause capacity issue or cascading failures</p>
<p><em><strong>Walk Policy Tree</strong></em></p>
<p>Generator traverses the policy tree in DFS order and creates an <em>action plan</em>.</p>
<p>The generator performs many steps such as checking predicates, checking rate limit conditions, etc.</p>
<p><em><strong>Carry out Action Plan</strong></em></p>
<p>The Action Orchestrator microservice is responsible for carrying out the action plan <strong>asynchronously</strong> from the policy tree walk session</p>
<p>This step involves <strong>making API calls to the corresponding compute managers</strong> since different actions may be implemented by different managers</p>
<p><em><strong>Log Action</strong></em></p>
<p>The logging format for Bandit learning is special since it requires not only recording the chosen action but also the associated probability.</p>
<p>In particular, the mitigation engine will log the action timestamp, experiment name, model type, model name, model version, action distributions, chosen action, chosen action parameters, etc.</p>
<p><em><strong>Track Node Health</strong></em></p>
<p>The <em>Health Tracker</em> tracks node and VM health information during the mitigation process</p>
<h3 id="learner">Learner</h3>
<p>a centralized component in Narya, learns the effect of mitigation action across different data center regions</p>
<p><strong>Advantage</strong>:</p>
<ul>
<li>observing more data points and hence more confidence in the cost estimation</li>
<li>a mitigation effect change in certain region due to software/firmware updates could be quickly learned and applied to other regions rolling out the same updates.</li>
</ul>
<p>2 main jobs:</p>
<ul>
<li><strong>Cost collection</strong>
<ul>
<li>retrieves the mitigation engine’s decisions from the logs</li>
<li>then correlated with the VM availability measurements and other important information</li>
<li>determine the cost of the mitigation action for training</li>
</ul>
</li>
<li><strong>Bandit model training</strong>
<ul>
<li>The <strong>output</strong> model of the learner is a <strong>categorical</strong> <strong>distribution</strong>, which the model server can easily draw samples from</li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Yuchen You (Wesley)</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/05/13/wesley_knowledge_repo/os/OrderLab/2.%20Predictive%20and%20Adaptive%20Failure%20Mitigation%20to%20Avert%20Production%20Cloud%20VM%20Interruptions/">http://example.com/2025/05/13/wesley_knowledge_repo/os/OrderLab/2.%20Predictive%20and%20Adaptive%20Failure%20Mitigation%20to%20Avert%20Production%20Cloud%20VM%20Interruptions/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/distributed-sys/">distributed_sys</a></div><div class="post_share"><div class="social-share" data-image="/img/me_new.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/15/wesley_knowledge_repo/os/mit_cs824/5.%20ZooKeeper/" title="5. ZooKeeper: Wait-free Coordination for Internet-scale Systems"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">5. ZooKeeper: Wait-free Coordination for Internet-scale Systems</div></div></a></div><div class="next-post pull-right"><a href="/2025/05/12/wesley_knowledge_repo/os/OrderLab/1.%20AIOpsLab%20A%20Holistic%20Framework%20to%20Evaluate%20AI%20Agents%20for%20Enabling%20Autonomous%20Clouds/" title="1. AIOpsLab: A Holistic Framework to Evaluate AI Agents for Enabling Autonomous Clouds"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">1. AIOpsLab: A Holistic Framework to Evaluate AI Agents for Enabling Autonomous Clouds</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2025/05/07/wesley_knowledge_repo/os/mit_cs824/1.%20MapReduce,%20Simplified%20Data%20Processing%20on%20Large%20Clusters/" title="1. Map Reduce, Simplified Data Processing on Large Clusters"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-07</div><div class="title">1. Map Reduce, Simplified Data Processing on Large Clusters</div></div></a></div><div><a href="/2025/05/07/wesley_knowledge_repo/os/Apache/1.%20Kafka/" title="1. Kafka"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-08</div><div class="title">1. Kafka</div></div></a></div><div><a href="/2025/05/08/wesley_knowledge_repo/os/mit_cs824/2.%20The%20Design%20of%20a%20Practical%20System%20for%20Fault-Tolerant%20Virtual%20Machines/" title="2. The Design of a Practical System for Fault-Tolerant Virtual Machines"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-09</div><div class="title">2. The Design of a Practical System for Fault-Tolerant Virtual Machines</div></div></a></div><div><a href="/2025/05/10/wesley_knowledge_repo/os/mit_cs824/0.%20Hadoop%20Distributed%20File%20System/" title="0. Hadoop Distributed File System"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-10</div><div class="title">0. Hadoop Distributed File System</div></div></a></div><div><a href="/2025/05/12/wesley_knowledge_repo/os/OrderLab/1.%20AIOpsLab%20A%20Holistic%20Framework%20to%20Evaluate%20AI%20Agents%20for%20Enabling%20Autonomous%20Clouds/" title="1. AIOpsLab: A Holistic Framework to Evaluate AI Agents for Enabling Autonomous Clouds"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-12</div><div class="title">1. AIOpsLab: A Holistic Framework to Evaluate AI Agents for Enabling Autonomous Clouds</div></div></a></div><div><a href="/2025/05/22/wesley_knowledge_repo/os/OrderLab/3.%20Metastable%20Failures%20in%20Distributed%20Systems/" title="3. Metastable Failures in Distributed Systems"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-22</div><div class="title">3. Metastable Failures in Distributed Systems</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/me_new.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Yuchen You (Wesley)</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">253</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/1WesleyYou"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/1Wesleyyou" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yuchenxr@umich.edu" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yuchen-you-a74940314/?locale=en_US" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #4a4dbe;"></i></a><a class="social-icon" href="/Resume.pdf" target="_blank" title="CV"><i class="fas fa-address-card" style="color: #251456;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#background-and-motivation"><span class="toc-number">2.</span> <span class="toc-text">Background and Motivation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#target-system-and-goal"><span class="toc-number">2.1.</span> <span class="toc-text">Target System and Goal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#are-failures-predictable"><span class="toc-number">2.2.</span> <span class="toc-text">Are Failures Predictable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#why-static-mitigation-is-insufficient"><span class="toc-number">2.3.</span> <span class="toc-text">Why Static Mitigation is Insufficient</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#overview"><span class="toc-number">3.</span> <span class="toc-text">Overview</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#workflow"><span class="toc-number">3.1.</span> <span class="toc-text">Workflow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optimization-metric"><span class="toc-number">3.2.</span> <span class="toc-text">Optimization Metric</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenges"><span class="toc-number">3.3.</span> <span class="toc-text">Challenges</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#predicting-node-failures"><span class="toc-number">4.</span> <span class="toc-text">Predicting Node Failures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#input-signals"><span class="toc-number">4.1.</span> <span class="toc-text">Input Signals</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rule-based-prediction"><span class="toc-number">4.2.</span> <span class="toc-text">Rule-based Prediction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#learning-based-prediction"><span class="toc-number">4.3.</span> <span class="toc-text">Learning-based Prediction</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mitigation-actions"><span class="toc-number">5.</span> <span class="toc-text">Mitigation Actions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#decision-logic-for-adaptive-mitigation"><span class="toc-number">6.</span> <span class="toc-text">Decision Logic for Adaptive Mitigation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#online-experimentation-with-a-b-testing"><span class="toc-number">6.1.</span> <span class="toc-text">Online Experimentation with A&#x2F;B Testing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#narya-system-design-and-implementation"><span class="toc-number">7.</span> <span class="toc-text">Narya System Design and Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#failure-predictor"><span class="toc-number">7.1.</span> <span class="toc-text">Failure Predictor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mitigation-engine"><span class="toc-number">7.2.</span> <span class="toc-text">Mitigation Engine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#learner"><span class="toc-number">7.3.</span> <span class="toc-text">Learner</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/31/wesley_knowledge_repo/os/OrderLab/6.%20Fail%20Stutter%20Fault%20Tolerance/" title="6. Fail Stutter Fault Tolerance">6. Fail Stutter Fault Tolerance</a><time datetime="2025-05-31T10:32:49.000Z" title="Created 2025-05-31 18:32:49">2025-05-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/27/wesley_knowledge_repo/os/OrderLab/5.%20Fail-Slow%20at%20Scale/" title="5. Fail-Slow at Scale">5. Fail-Slow at Scale</a><time datetime="2025-05-27T07:11:00.000Z" title="Created 2025-05-27 15:11:00">2025-05-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/25/wesley_knowledge_repo/os/tools_frames/1.%20Kubernetes%20%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/" title="1. Kubernetes 核心概念">1. Kubernetes 核心概念</a><time datetime="2025-05-25T11:45:47.000Z" title="Created 2025-05-25 19:45:47">2025-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/23/wesley_knowledge_repo/os/Unix/1.%20Boot%20and%20System%20Management%20Daemons/" title="1. Boot and System Management Daemons">1. Boot and System Management Daemons</a><time datetime="2025-05-23T04:58:57.000Z" title="Created 2025-05-23 12:58:57">2025-05-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/22/wesley_knowledge_repo/os/OrderLab/3.%20Metastable%20Failures%20in%20Distributed%20Systems/" title="3. Metastable Failures in Distributed Systems">3. Metastable Failures in Distributed Systems</a><time datetime="2025-05-22T13:38:11.000Z" title="Created 2025-05-22 21:38:11">2025-05-22</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Yuchen You (Wesley)</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>