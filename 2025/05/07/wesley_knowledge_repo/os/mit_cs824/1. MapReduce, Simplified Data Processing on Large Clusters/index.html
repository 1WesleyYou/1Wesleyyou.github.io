<!DOCTYPE html><html lang="en-US" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>1. Map Reduce, Simplified Data Processing on Large Clusters | Yuchen You</title><meta name="author" content="Yuchen You (Wesley)"><meta name="copyright" content="Yuchen You (Wesley)"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="link for this paper: mapreduce link for mit cs6.824 lecture: lecture 1  ([[mapreduce-osdi04.pdf#page&#x3D;1&amp;selection&#x3D;10,0,12,10&amp;color&#x3D;yellow|MapReduce is a programming model and an associated impl">
<meta property="og:type" content="article">
<meta property="og:title" content="1. Map Reduce, Simplified Data Processing on Large Clusters">
<meta property="og:url" content="http://example.com/2025/05/07/wesley_knowledge_repo/os/mit_cs824/1.%20MapReduce,%20Simplified%20Data%20Processing%20on%20Large%20Clusters/index.html">
<meta property="og:site_name" content="Yuchen You">
<meta property="og:description" content="link for this paper: mapreduce link for mit cs6.824 lecture: lecture 1  ([[mapreduce-osdi04.pdf#page&#x3D;1&amp;selection&#x3D;10,0,12,10&amp;color&#x3D;yellow|MapReduce is a programming model and an associated impl">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/me_new.jpeg">
<meta property="article:published_time" content="2025-05-07T08:47:57.000Z">
<meta property="article:modified_time" content="2025-05-09T15:22:50.716Z">
<meta property="article:author" content="Yuchen You (Wesley)">
<meta property="article:tag" content="distributed_sys">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/me_new.jpeg"><link rel="shortcut icon" href="/img/hackerrank.svg"><link rel="canonical" href="http://example.com/2025/05/07/wesley_knowledge_repo/os/mit_cs824/1.%20MapReduce,%20Simplified%20Data%20Processing%20on%20Large%20Clusters/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '1. Map Reduce, Simplified Data Processing on Large Clusters',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-09 23:22:50'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/me_new.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">292</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/math_master.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="Yuchen You"><img class="site-icon" src="/img/avatar.png"/><span class="site-name">Yuchen You</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">1. Map Reduce, Simplified Data Processing on Large Clusters</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-05-07T08:47:57.000Z" title="Created 2025-05-07 16:47:57">2025-05-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-09T15:22:50.716Z" title="Updated 2025-05-09 23:22:50">2025-05-09</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="1. Map Reduce, Simplified Data Processing on Large Clusters"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>link for this paper: <a target="_blank" rel="noopener" href="https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/mapreduce-osdi04.pdf">mapreduce</a><br>
link for mit cs6.824 lecture: <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1DiVpzPEAY/?spm_id_from=333.337.search-card.all.click&amp;vd_source=2ceaabc8a41d33275e49256f655eb432">lecture 1</a></p>
<blockquote>
<p>([[mapreduce-osdi04.pdf#page=1&amp;selection=10,0,12,10&amp;color=yellow|MapReduce is a programming model and an associated implementation for processing and generating large data sets.]])</p>
<ul>
<li>contribution:
<ul>
<li>可以运行在 commodity machines 上面, scalable</li>
<li>在上千台机器上运行大量数据 (# terabytes)</li>
<li>programmer 不需知道很多并行相关的知识, <strong>easy to use</strong>
<ul>
<li>hides detail for parallelization, fault-tolerance, locality optimization, and load balancing</li>
<li>many <strong>problems</strong> are easily expressible</li>
</ul>
</li>
</ul>
</li>
<li>result:
<ul>
<li>implement MR, so that it can compromise thousands of machines</li>
<li>restrict model to make it <strong>easy</strong> to para + distribute + (computational) fault-tolerant</li>
<li>network <strong>bandwidth</strong> 节流: target at reduce the data send across the network</li>
<li><strong>redundant</strong> execution 数据与性能稳定: reduce the impact of slow machines and to handle failures</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p>([[mapreduce-osdi04.pdf#page=1&amp;selection=12,10,23,49&amp;color=yellow|Users specify a map function that processes a key/value pair to generate a set of intermediate key/value pairs, and a reduce function that merges all intermediate values associated with the same intermediate key.]])</p>
<ul>
<li>map:  把一个输入的 key/val 对进行处理而生成一系列的 键值对</li>
<li>reduce: 讲所有的中间值合并起来并且联系到同一个 intermediate key</li>
</ul>
</blockquote>
<blockquote>
<p>[!PDF|yellow] [[mapreduce-osdi04.pdf#page=1&amp;selection=62,29,66,13&amp;color=yellow|mapreduce-osdi04, p.1]]</p>
<blockquote>
<p>The issues of how to parallelize the computation, distribute the data, and handle failures conspire to obscure the original simple computation with large amounts of complex code to deal with these issues.</p>
</blockquote>
<ul>
<li>目的: 并行处理计算，兼顾 fault-tolerance</li>
</ul>
</blockquote>
<blockquote>
<p>[!PDF|yellow] [[mapreduce-osdi04.pdf#page=1&amp;selection=103,0,107,51&amp;color=yellow|mapreduce-osdi04, p.1]]</p>
<blockquote>
<p>The major contributions of this work are a simple and powerful interface that enables automatic parallelization and distribution of large-scale computations, combined with an implementation of this interface that achieves high performance on large clusters of commodity PCs</p>
</blockquote>
<ul>
<li>应用于商业 pc</li>
</ul>
</blockquote>
<h2 id="目录">目录</h2>
<ul>
<li>section 2: programming model and examples</li>
<li>section 3: implementation of MapReduce interface (for cluster-based computing environment)</li>
<li>section 4: refinements of the model</li>
<li>section 5: performance measurement</li>
<li>section 6: use of MapReduce within Google</li>
<li>section 7: related and future work</li>
</ul>
<h2 id="section-2-programming-model">Section 2: programming model</h2>
<h3 id="map">Map</h3>
<blockquote>
<p>[!PDF|yellow] [[mapreduce-osdi04.pdf#page=2&amp;selection=31,0,48,9&amp;color=yellow|mapreduce-osdi04, p.2]]</p>
<blockquote>
<p>Map, written by the user, takes an input pair and produces a set of intermediate key/value pairs. The MapReduce library groups together all intermediate values associated with the same intermediate key I and passes them to the Reduce function.</p>
</blockquote>
</blockquote>
<p>Map过程将原始数据转换成key/value pairs</p>
<p>以最简单的word count程序为例，这个程序的功能是计算文件中每个单词的出现次数; 由此，我们将一个输入文件 map 到了一个 key/value 数组</p>
<h3 id="reduce">Reduce</h3>
<blockquote>
<p>[!PDF|yellow] [[mapreduce-osdi04.pdf#page=2&amp;selection=49,0,68,22&amp;color=yellow|mapreduce-osdi04, p.2]]</p>
<blockquote>
<p>The Reduce function, also written by the user, accepts an intermediate key I and a set of values for that key. It merges together these values to form a possibly smaller set of values. Typically just zero or one output value is produced per Reduce invocation. The intermediate values are supplied to the user’s reduce function via an iterator. This allows us to handle lists of values that are too large to fit in memory.</p>
</blockquote>
</blockquote>
<p>对于map输出的key/value pairs, Reduce是将相同key值的value合并的过程</p>
<p>每一个reducer处理特定的word。相同word的key/value pair进入同一个reducer, 统计计数</p>
<p><img src="/images/mapreduce_map.svg" alt="mapreduce_map"></p>
<h3 id="其他例子">其他例子</h3>
<ul>
<li>Distribute Grep (分布式全文计数)
<ul>
<li>Map: (key: 文件名+偏移量, val: 该行文本内容) -&gt; 如果该行文本匹配输入的内容，就 emit</li>
<li>Reduce: 直接输出所有查找结果</li>
<li>应用: 可以用于分布式集群的并行查找文本</li>
</ul>
</li>
<li>URL access frequency
<ul>
<li>Map: raw log -&gt; (url, 1)</li>
<li>Reduce: [(url1, 1)…] -&gt; (url, count_of_url1)</li>
</ul>
</li>
</ul>
<h2 id="section-3-implementation">Section 3: Implementation</h2>
<h3 id="map">Map</h3>
<ul>
<li>
<p>input are automatically splitted into M parts.</p>
</li>
<li>
<p>input splits acn be processed in parallel by different machines.</p>
</li>
</ul>
<h3 id="reduce">Reduce</h3>
<ul>
<li>把 map 阶段产生的中间 键值对 分块到 R 个 pieces, 类似于 hash 函数的方法;</li>
</ul>
<p><img src="/images/mapreduce_workflow.png" alt="mapreduceworkflow"></p>
<h3 id="workflow">WorkFlow</h3>
<ul>
<li>有一个 master pc 用于统筹规划所有的 pc, 其余所有工作机都是 worker</li>
<li>master 会把 idle 状态下的 worker 分配任务 (一共有 M 个 map task 与 R 个 reduce task)</li>
<li>被分配到 map 任务的 worker 会读取被分裂之后的数据 (尺寸一般在 16-64 MB), 并且 map 的结果 (中间键值对) 会被 buffer 在内存中</li>
<li>被缓存的 map 输出会被周期性地写入到 <strong>本地</strong> disk 中，并且 partition 到 R 个区域 (partitioning function) 来用作 reduce 的 src 数据, 并且此 worker 需要把存入的数据地址反向发送给 master 然后由 master 转发给 reduce worker</li>
<li>reduce worker 在收到 master 通知之后会使用 RPC 来读取 存入的数据 (map worker’s local disk); 读完之后会讲所有中间 key 进行排序</li>
<li>根据用户输入进行查询并且返回对应的查询结果 (在 R 个 reduce worker 的本地, 即返回的数据是 R 个离散表)</li>
</ul>
<h3 id="master-data-structure">Master Data Structure</h3>
<p>对于每一个 map 任务和 reduce 任务, 会存储其状态 (idle/in-progress/completed), 并存储每一个 worker 的 状态</p>
<p>master 可以被视作是一个 中间文件传播器, 即把 map 任务生成的文件传输到 reduce 任务的输入</p>
<h2 id="fault-tolerance">Fault-Tolerance</h2>
<h3 id="worker-failure">Worker Failure</h3>
<p>master 周期性地向每一个用户发送 ping 请求, 如果经过一定长度的时间没有收到来自对应 worker 的 reply 那么就会认为 worker failed.</p>
<p>每一个完成 map 任务的 worker 都会被设置状态为 idle (即最初的状态), 并且因此变得非常容易调度; 因此每一个 in-progress failed 的任务都会被 reset 为 idle</p>
<p>对于一些刚刚完成任务的 map worker 如果发生 failure 仍然要被 reset 到 idle, 因为 map 任务的结果是存储在 local disk 上的; 而如果是完成的 reduce worker 发生 failure 不要紧，因为其输出是存储在 global file system 中的</p>
<p>如果在形如 A(map worker) -&gt; B(reduce worker) 的供给链中, 如果 A 发生了 failure 那么会 notify 所有的 用户机器告知其发生了 re-execution</p>
<h3 id="master-failure">Master Failure</h3>
<p>如果宿主机发生了问题，那么只需要新引入一个 master 并且从每个 worker 处读取进度并且继续下去</p>
<p>且由于宿主机只有一台，其发生问题的概率是比较低的</p>
<h3 id="semantics-in-the-presence-of-failures">Semantics in the Presence of Failures</h3>
<p>map-reduce 函数应该是一个 deterministic 函数, 即对于相同的输入其应该获得相同的输出</p>
<p>因此分布式的程序输出应该和 sequential + non-faulting 的程序输出保持一致</p>
<p>提出了以下要求:<br>
<strong>atomic commits</strong>: 每个 in-progress task 讲输出存入一个 private temporary file, 每个 reduce task 会生成一个这样的文件，而一个 map 任务会生成 R 个对应的文件 (每个 reduce 任务对应一个 文件); 当一个 map 任务完成的时候， worker 会发送一个 msg 给 master, 包含 R 个临时文件的名称; 当一个 reduce 任务完成之后 reduce worker 会原子性地把临时文件重命名为 最终输出文件名称 (如果有多个 reduce worker 在执行相同的工作那么会得到相同的输出文件被改成相同的名称, 只要确保改名过程是 原子性的, 那么我们就能确保最终输出会指向某一个合法的 reduce 输出文件)</p>
<p>如果 map/reduce 函数本身并不是 deterministic, 那么我们要提供一个相对更加弱但是确实合理的 semantics. 对于一个非确定性函数的存在，某个 reduce 任务的输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 等价于 sequential non-deterministic program 的输出; 但是<strong>问题是</strong> 一个非确定任务的输出可能会等价于 不同任务的 sequential 执行输出 (这里对标的应当是 sequential 的执行输出的时候应当认为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是来自同一批次的输出)</p>
<p>定义 map 任务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>, reduce 任务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 执行任务的函数函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 表示任务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 已经被 committed, <strong>弱条件下的 failure 语义可能仍然有效</strong>, 即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>e</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e(R_1), e(R_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 可能会读取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 的不同批次输出 (对标 sequential 输出的情况)</p>
<h3 id="locality">Locality</h3>
<p>由于网络带宽是一个相对稀缺的资源, 因此我们把输入数据提前存储在本地 disk 上来形成 cluster, GFS 能讲每个文件分成 64MB 的 block, 并且存储多个 copy (replicate index = 3) , 而 master 在分配任务的时候也要把 location 信息考虑进来, 并且尝试 schedule 一个 map 任务到拥有对应 copy 的 worker 机器上, 这样如果发生了 Failure, 就可以尝试直接就进跑到 replica 机器上</p>
<p><strong>最终目的&amp;结果</strong>: 当运行大尺度的 MapReduce 指令的时候, 绝大多数的输入数据是从本地存储读取出来的, 从而节省了大量的 network 带宽</p>
<h3 id="task-granularity">Task Granularity</h3>
<p>在存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 个 map 输出和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 个 reduce 任务的时候, 应当假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>&gt;</mo><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">M &gt;&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span></span></span></span> worker number, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&gt;</mo><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">R &gt;&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span></span></span></span> worker number</p>
<p>让每一个 worker 执行许多不同的任务能提升 dynamic load balancing, 并且 speeds up recovery: 如果其中一个 worker fail, 其完成的 map 任务部分可以通过其他 worker 传播出去</p>
<p>从上文可知复杂度的推演是主要考虑 M 和 R 的数量而非 worker 数量</p>
<ul>
<li>时间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>M</mi><mo>+</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(M+R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 因为一共有 M + R 个 选择要做</li>
<li>空间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>M</mi><mo>∗</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(M*R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 因为要存储每个 map 是否完成, 以及给其分配的 reduce 任务的状态 (是否已经从对应的任务手中读取到 数据), 并且要维护一个 Map-Reduce 一一对应的关系, 来确保数据 network flow 以及 replication</li>
</ul>
<p>但是由于 输出文件的体量受到 用户指定的限制, 因此实际上我们会倾向于根据输出尺寸选择 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 的尺寸以达到 16 - 64 MB 的工作尺寸, 并且我们会让 R 为 worker 数量的倍数</p>
<h3 id="backup-tasks">Backup Tasks</h3>
<p><strong>Straggler彳亍者</strong>: 一个机器, 花费很长的时间来完成最近的几次 map-reduce 任务计算</p>
<p>存在原因:</p>
<ol>
<li>如果一个机器有很差的硬盘，那么可能会经常发生 correctable errors, 但是会降低 read performance (30MBps -&gt; 1 MBps) 然后中央调度器可能已经提前布置了其他的很多任务于这个机器上，导致其执行会很缓慢</li>
</ol>
<p>解决方案:</p>
<ol>
<li>当一个 MR 执行接近尾声的时候, master 要对于 剩下的所有 in-progress 任务 schedule 一个 backup execution (也就是将所有没完成的任务给已经跑完的任务再次执行), 那么无论是原来的任务完成了或者是新分配的任务完成了, 对应的任务都会被认为是完成了的</li>
</ol>
<h2 id="refinements">Refinements</h2>
<h3 id="partitioning-function">Partitioning Function</h3>
<p>MapReduce 的用户会指定他们想要的输出文件数量, 数据因此会被分区到这些任务中, 这个过程使用的分区函数就是 partitioning function, 分区的索引是 intermediate key</p>
<p>常用的方法是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>hash(key)</mtext><mspace></mspace><mspace width="0.6666666666666666em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>R</mi></mrow><annotation encoding="application/x-tex">\text{hash(key)}\mod R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">hash(key)</span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 并且注意这里的 哈希函数本身是一个 deterministic 函数, 因此如果想要将一定的内容根据其特殊的分类聚合起来, 就需要提前设计一个聚合函数 f 来达到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>hash(f(key))</mtext><mspace></mspace><mspace width="0.6666666666666666em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>R</mi></mrow><annotation encoding="application/x-tex">\text{hash(f(key))}\mod R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">hash(f(key))</span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 一样的效果</p>
<p>这个分区函数的目的是形成 <strong>fairly well-balanced partitions</strong></p>
<h3 id="ordering-guarantees">Ordering Guarantees</h3>
<p>我们确保在给定 分区内, intermediate key/val pairs 会通过 key 的升序排序进行处理, 这样的顺序能确保更加容易地输出每个 partition 内的有序文件, 对于输出文件能支持高效地关于 key 进行 random access 或者在用户端更加容易地对输出数据进行排序显示</p>
<h3 id="combiner-function">Combiner Function</h3>
<p>在某些场合下会出现多个 map 任务产生的 intermediate key 中有非常多的 repetition, 且用户端对于 reduce 函数的要求是允许 commutative (交换律) 和 associative (结合律) 的, 例如在统计多个文件中单词计数, 对于单词 <code>the</code> 的计数可能是非常多个 <code>(the, 1)</code> 的键值对的组合, 如果发生在每个 map 向 reduce 的传递过程中会存在非常多的赘余</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Yuchen You (Wesley)</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/05/07/wesley_knowledge_repo/os/mit_cs824/1.%20MapReduce,%20Simplified%20Data%20Processing%20on%20Large%20Clusters/">http://example.com/2025/05/07/wesley_knowledge_repo/os/mit_cs824/1.%20MapReduce,%20Simplified%20Data%20Processing%20on%20Large%20Clusters/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/distributed-sys/">distributed_sys</a></div><div class="post_share"><div class="social-share" data-image="/img/me_new.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/07/wesley_knowledge_repo/os/Apache/1.%20Kafka/" title="1. Kafka"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">1. Kafka</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/10/wesley_knowledge_repo/cs/%E7%8E%B0%E4%BB%A3cpp%E7%89%B9%E6%80%A7/" title="现代cpp特性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">现代cpp特性</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2025/05/07/wesley_knowledge_repo/os/Apache/1.%20Kafka/" title="1. Kafka"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-08</div><div class="title">1. Kafka</div></div></a></div><div><a href="/2025/05/08/wesley_knowledge_repo/os/mit_cs824/2.%20The%20Design%20of%20a%20Practical%20System%20for%20Fault-Tolerant%20Virtual%20Machines/" title="2. The Design of a Practical System for Fault-Tolerant Virtual Machines"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-09</div><div class="title">2. The Design of a Practical System for Fault-Tolerant Virtual Machines</div></div></a></div><div><a href="/2025/05/10/wesley_knowledge_repo/os/mit_cs824/0.%20Hadoop%20Distributed%20File%20System/" title="0. Hadoop Distributed File System"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-10</div><div class="title">0. Hadoop Distributed File System</div></div></a></div><div><a href="/2025/05/13/wesley_knowledge_repo/os/OrderLab/2.%20Predictive%20and%20Adaptive%20Failure%20Mitigation%20to%20Avert%20Production%20Cloud%20VM%20Interruptions/" title="2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-13</div><div class="title">2. Predictive and Adaptive Failure Mitigation to Avert Production Cloud VM Interruptions</div></div></a></div><div><a href="/2025/05/12/wesley_knowledge_repo/os/OrderLab/1.%20AIOpsLab%20A%20Holistic%20Framework%20to%20Evaluate%20AI%20Agents%20for%20Enabling%20Autonomous%20Clouds/" title="1. AIOpsLab: A Holistic Framework to Evaluate AI Agents for Enabling Autonomous Clouds"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-12</div><div class="title">1. AIOpsLab: A Holistic Framework to Evaluate AI Agents for Enabling Autonomous Clouds</div></div></a></div><div><a href="/2025/05/22/wesley_knowledge_repo/os/OrderLab/3.%20Metastable%20Failures%20in%20Distributed%20Systems/" title="3. Metastable Failures in Distributed Systems"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-22</div><div class="title">3. Metastable Failures in Distributed Systems</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/me_new.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Yuchen You (Wesley)</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">292</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/1WesleyYou"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/1Wesleyyou" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yuchenxr@umich.edu" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yuchen-you-a74940314/?locale=en_US" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #4a4dbe;"></i></a><a class="social-icon" href="/Resume.pdf" target="_blank" title="CV"><i class="fas fa-address-card" style="color: #251456;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#section-2-programming-model"><span class="toc-number">2.</span> <span class="toc-text">Section 2: programming model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#map"><span class="toc-number">2.1.</span> <span class="toc-text">Map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reduce"><span class="toc-number">2.2.</span> <span class="toc-text">Reduce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%BE%8B%E5%AD%90"><span class="toc-number">2.3.</span> <span class="toc-text">其他例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#section-3-implementation"><span class="toc-number">3.</span> <span class="toc-text">Section 3: Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#map"><span class="toc-number">3.1.</span> <span class="toc-text">Map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reduce"><span class="toc-number">3.2.</span> <span class="toc-text">Reduce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#workflow"><span class="toc-number">3.3.</span> <span class="toc-text">WorkFlow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#master-data-structure"><span class="toc-number">3.4.</span> <span class="toc-text">Master Data Structure</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fault-tolerance"><span class="toc-number">4.</span> <span class="toc-text">Fault-Tolerance</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#worker-failure"><span class="toc-number">4.1.</span> <span class="toc-text">Worker Failure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#master-failure"><span class="toc-number">4.2.</span> <span class="toc-text">Master Failure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#semantics-in-the-presence-of-failures"><span class="toc-number">4.3.</span> <span class="toc-text">Semantics in the Presence of Failures</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locality"><span class="toc-number">4.4.</span> <span class="toc-text">Locality</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#task-granularity"><span class="toc-number">4.5.</span> <span class="toc-text">Task Granularity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#backup-tasks"><span class="toc-number">4.6.</span> <span class="toc-text">Backup Tasks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#refinements"><span class="toc-number">5.</span> <span class="toc-text">Refinements</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#partitioning-function"><span class="toc-number">5.1.</span> <span class="toc-text">Partitioning Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ordering-guarantees"><span class="toc-number">5.2.</span> <span class="toc-text">Ordering Guarantees</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#combiner-function"><span class="toc-number">5.3.</span> <span class="toc-text">Combiner Function</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/30/wesley_knowledge_repo/os/historical/19.scheduler_activation/" title="19.scheduler_activation">19.scheduler_activation</a><time datetime="2025-09-30T13:23:07.000Z" title="Created 2025-09-30 21:23:07">2025-09-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/29/wesley_knowledge_repo/os/historical/18.vmware_esx_mem/" title="18.vmware_esx_mem">18.vmware_esx_mem</a><time datetime="2025-09-29T05:19:27.000Z" title="Created 2025-09-29 13:19:27">2025-09-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/28/wesley_knowledge_repo/os/historical/17.superpage/" title="17.superpage">17.superpage</a><time datetime="2025-09-28T08:35:17.000Z" title="Created 2025-09-28 16:35:17">2025-09-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/25/wesley_knowledge_repo/ds/3.PB-Replication%20&amp;%20Linearizability/" title="3.PB-Replication &amp; Linearizability">3.PB-Replication &amp; Linearizability</a><time datetime="2025-09-25T13:20:55.000Z" title="Created 2025-09-25 21:20:55">2025-09-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/23/wesley_knowledge_repo/os/historical/15.vm_lighter_than_container/" title="15.vm_lighter_than_container">15.vm_lighter_than_container</a><time datetime="2025-09-23T11:03:49.000Z" title="Created 2025-09-23 19:03:49">2025-09-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Yuchen You (Wesley)</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>